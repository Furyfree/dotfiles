#######################################
# ENVIRONMENT VARIABLES
#######################################
export EDITOR=vim
export PATH="$HOME/.pyenv/bin:$HOME/.jenv/bin:$PATH"
export FZF_CTRL_R_OPTS="--preview 'bat <<< {}' --preview-window=down:3:wrap"
export STARSHIP_CONFIG=$HOME/.config/starship/starship.toml

# Pyenv
eval "$(pyenv init --path)"
eval "$(pyenv init -)"
# eval "$(pyenv virtualenv-init -)"  # Uncomment if needed

# Jenv
eval "$(jenv init -)"

# Starship
eval "$(starship init zsh)"

# Zoxide
eval "$(zoxide init zsh)"

# FZF (keybindings and completion)
eval "$(fzf --zsh)"

#######################################
# HISTORY CONFIG
#######################################
HISTFILE=~/.zsh_history
HISTSIZE=100000
SAVEHIST=100000

setopt APPEND_HISTORY
setopt INC_APPEND_HISTORY
setopt SHARE_HISTORY
setopt HIST_IGNORE_DUPS
setopt HIST_IGNORE_ALL_DUPS
setopt HIST_IGNORE_SPACE
setopt HIST_REDUCE_BLANKS
setopt HIST_VERIFY

#######################################
# ZINIT (PLUGIN MANAGER)
#######################################
if [[ ! -f $HOME/.local/share/zinit/zinit.git/zinit.zsh ]]; then
  echo "Installing Zinit..."
  mkdir -p "$HOME/.local/share/zinit" && chmod g-rwX "$HOME/.local/share/zinit"
  git clone https://github.com/zdharma-continuum/zinit "$HOME/.local/share/zinit/zinit.git" && \
    echo "Zinit installed." || echo "Failed to install Zinit."
fi

source "$HOME/.local/share/zinit/zinit.git/zinit.zsh"
autoload -Uz _zinit
autoload -Uz compinit
compinit
(( ${+_comps} )) && _comps[zinit]=_zinit

# Plugins
zinit light zsh-users/zsh-autosuggestions
zinit light zsh-users/zsh-syntax-highlighting
zinit light zsh-users/zsh-completions
zinit light zsh-users/zsh-history-substring-search
zinit snippet OMZL::git.zsh
zinit snippet OMZP::git
zinit light Aloxaf/fzf-tab
zinit load junegunn/fzf

#######################################
# ALIASES
#######################################

# General
alias y='yazi'
alias ls='eza --icons --grid --group-directories-first'
alias ll='eza -lah --icons --group-directories-first'
alias lt='eza --tree --icons --group-directories-first'
alias la='eza -a --icons --grid --group-directories-first'
alias cat='bat'
alias c='clear'
alias e='exit'
alias f='fastfetch'
alias help='tldr'
alias mkdir='mkdir -p'
alias updatedb='sudo /usr/libexec/locate.updatedb'

# Find
alias find='fd'
alias fzf-find='fd --type f | fzf'

# Git
alias gt="git"
alias ga="git add ."
alias gs="git status -s"
alias gc='git commit -m'
alias glog='git log --oneline --graph --all'

# Maven
alias mvn-run='./mvnw spring-boot:run'
alias mvn-clean='./mvnw clean'
alias mvn-test='./mvnw test'
alias mvn-package='./mvnw package'
alias mvn-install='./mvnw install'
alias mvn-compile='./mvnw compile'

# Homebrew
alias brewup="brew update && brew upgrade"
alias brewclean="brew autoremove && brew cleanup"
alias brews="brew search"
alias brewi="brew install"
alias brewu="brew uninstall"
alias brewl="brew list"

# Lazy
alias lg="lazygit"

# Nix
alias drs='sudo nix run github:lnl7/nix-darwin --extra-experimental-features nix-command --extra-experimental-features flakes -- switch --flake ~/nix-darwin'
alias drb='darwin-rebuild build --flake ~/nix-darwin'
alias dre='vim ~/nix-darwin/flake.nix'
alias drc='darwin-rebuild changelog'

# Added by LM Studio CLI (lms)
export PATH="$PATH:/Users/pby/.lmstudio/bin"
# End of LM Studio CLI section

